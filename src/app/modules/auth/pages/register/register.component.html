<div class="register-container"> <div class="register-box">
    <h2>Crear Cuenta</h2>
    <p class="subtitle">Únete a nuestra plataforma de RRHH</p>

    @if (errorMessage) {
      <div class="alert alert-danger">
        {{ errorMessage }}
      </div>
    }

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

      <h4 class="form-section-title">Datos Personales</h4>

      <div class="form-row"> <div class="form-group col">
          <label for="firstName">Nombre</label>
          <input type="text" id="firstName" formControlName="firstName"
            [class.is-invalid]="f.firstName.invalid && (f.firstName.dirty || f.firstName.touched)">
          @if (f.firstName.invalid && (f.firstName.dirty || f.firstName.touched)) {
            <div class="invalid-feedback">
              @if (f.firstName.errors?.['required']) { <div>El nombre es obligatorio.</div> }
              @if (f.firstName.errors?.['minlength']) { <div>Mínimo 2 caracteres.</div> }
            </div>
          }
        </div>

        <div class="form-group col">
          <label for="lastName">Apellido</label>
          <input type="text" id="lastName" formControlName="lastName"
            [class.is-invalid]="f.lastName.invalid && (f.lastName.dirty || f.lastName.touched)">
          @if (f.lastName.invalid && (f.lastName.dirty || f.lastName.touched)) {
            <div class="invalid-feedback">
              @if (f.lastName.errors?.['required']) { <div>El apellido es obligatorio.</div> }
            </div>
          }
        </div>
      </div>

      <div class="form-row">
         <div class="form-group col">
          <label for="identifier">Identificación (DNI/NIE)</label>
          <input type="text" id="identifier" formControlName="identifier"
            [class.is-invalid]="f.identifier.invalid && (f.identifier.dirty || f.identifier.touched)">
           @if (f.identifier.invalid && (f.identifier.dirty || f.identifier.touched)) {
            <div class="invalid-feedback"> Campo obligatorio. </div>
          }
        </div>

        <div class="form-group col">
          <label for="gender">Género</label>
          <select id="gender" formControlName="gender"
              [class.is-invalid]="f.gender.invalid && (f.gender.dirty || f.gender.touched)">
            @for (option of genderOptions; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
           @if (f.gender.invalid && (f.gender.dirty || f.gender.touched)) {
            <div class="invalid-feedback"> Selecciona un género. </div>
          }
        </div>
      </div>


      <h4 class="form-section-title mt-4">Contacto y Acceso</h4>

       <div class="form-group">
        <label for="phone">Teléfono</label>
        <input type="tel" id="phone" formControlName="phone" placeholder="+34600000000"
          [class.is-invalid]="f.phone.invalid && (f.phone.dirty || f.phone.touched)">
        @if (f.phone.invalid && (f.phone.dirty || f.phone.touched)) {
          <div class="invalid-feedback">
            @if (f.phone.errors?.['required']) { <div>El teléfono es obligatorio.</div> }
            @if (f.phone.errors?.['pattern']) { <div>Solo números y símbolo '+'.</div> }
          </div>
        }
      </div>

      <div class="form-group">
        <label for="email">Correo Electrónico</label>
        <input type="email" id="email" formControlName="email"
          [class.is-invalid]="f.email.invalid && (f.email.dirty || f.email.touched)">
        @if (f.email.invalid && (f.email.dirty || f.email.touched)) {
          <div class="invalid-feedback">
            @if (f.email.errors?.['required']) { <div>El correo es obligatorio.</div> }
            @if (f.email.errors?.['email']) { <div>Introduce un correo válido.</div> }
          </div>
        }
      </div>

      <div class="form-group">
        <label for="password">Contraseña</label>
        <input type="password" id="password" formControlName="password"
          [class.is-invalid]="f.password.invalid && (f.password.dirty || f.password.touched)">
        @if (f.password.invalid && (f.password.dirty || f.password.touched)) {
          <div class="invalid-feedback">
            @if (f.password.errors?.['required']) { <div>La contraseña es obligatoria.</div> }
            @if (f.password.errors?.['minlength']) { <div>Mínimo 8 caracteres.</div> }
          </div>
        }
      </div>

      <button type="submit" class="btn-primary" [disabled]="registerForm.invalid || isLoading">
        @if (isLoading) { <span>Registrando...</span> } @else { Crear Cuenta }
      </button>

    </form>

    <div class="footer-links">
      <p>¿Ya tienes cuenta? <a routerLink="/auth/login">Inicia sesión aquí</a></p>
    </div>

  </div>
</div>